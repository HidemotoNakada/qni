<%= container do %>
  <p id="notice" class="mt-6">
    <%= notice %>
  </p>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_column do %>
    <%%= qubit_value_label label: '0x1' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= write value: 0 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= hadamard_gate %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= readout value: 1 %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'Random bit', circuit_erb: circuit_erb do %>
    <%= circle_notation do %>
      <%= qubit_circle_group do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_column do %>
    <%%= qubit_value_label label: '0x1' %>
    <%%= qubit_value_label label: '0x2' %>
    <%%= qubit_value_label label: '0x4' %>
    <%%= qubit_value_label label: '0x8' %>
    <%%= qubit_value_label label: '0x10' %>
    <%%= qubit_value_label label: '0x20' %>
    <%%= qubit_value_label label: '0x40' %>
    <%%= qubit_value_label label: '0x80' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= write value: 0 %>
    <%%= write value: 0 %>
    <%%= write value: 0 %>
    <%%= write value: 0 %>
    <%%= write value: 0 %>
    <%%= write value: 0 %>
    <%%= write value: 0 %>
    <%%= write value: 0 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= hadamard_gate %>
    <%%= hadamard_gate %>
    <%%= hadamard_gate %>
    <%%= hadamard_gate %>
    <%%= hadamard_gate %>
    <%%= hadamard_gate %>
    <%%= hadamard_gate %>
    <%%= hadamard_gate %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= readout value: 0 %>
    <%%= readout value: 1 %>
    <%%= readout value: 1 %>
    <%%= readout value: 0 %>
    <%%= readout value: 1 %>
    <%%= readout value: 0 %>
    <%%= readout value: 0 %>
    <%%= readout value: 1 %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'Random byte', circuit_erb: circuit_erb, class: 'mt-8' do %>
    <%= circle_notation size: :xs do %>
      <%= qubit_circle_group do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <% 1.upto(15) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 16.upto(31) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 32.upto(47) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 48.upto(63) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 64.upto(79) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 80.upto(95) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 96.upto(111) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 112.upto(127) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 128.upto(143) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 144.upto(159) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 160.upto(175) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 176.upto(191) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 192.upto(207) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 208.upto(223) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 224.upto(239) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 240.upto(255) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <% 1.upto(15) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 16.upto(31) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 32.upto(47) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 48.upto(63) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 64.upto(79) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 80.upto(95) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 96.upto(111) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 112.upto(127) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 128.upto(143) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 144.upto(159) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 160.upto(175) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 176.upto(191) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 192.upto(207) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 208.upto(223) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 224.upto(239) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 240.upto(255) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <% 0.upto(15) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 16.upto(31) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 32.upto(47) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 48.upto(63) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 64.upto(79) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 80.upto(95) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 96.upto(111) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 112.upto(127) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 128.upto(143) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 144.upto(159) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 160.upto(175) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 176.upto(191) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 192.upto(207) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 208.upto(223) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 224.upto(239) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 240.upto(255) do |each| %>
            <%= qubit_circle ket: each, magnitude: 1 / Math.sqrt(256), magnitude_string: '1/16' %>
          <% end %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <% 0.upto(15) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 16.upto(31) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 32.upto(47) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 48.upto(63) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 64.upto(79) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 80.upto(95) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 96.upto(111) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 112.upto(127) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 128.upto(143) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 144.upto(159) do |each| %>
            <% if each == 150 %>
              <%= qubit_circle ket: each, magnitude: 1 %>
            <% else %>
              <%= qubit_circle ket: each, magnitude: 0 %>
            <% end %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 160.upto(175) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 176.upto(191) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 192.upto(207) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 208.upto(223) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 224.upto(239) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
        <%= qubit_circle_group_row do %>
          <% 240.upto(255) do |each| %>
            <%= qubit_circle ket: each, magnitude: 0 %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_header do %>
    <%%= circuit_column do %>
      <%%= qubit_value_label label: '0x1' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= write value: 0 %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'RNOT' do %>
    <%%= circuit_column do %>
      <%%= hadamard_gate %>
    <%% end %>

      <%%= circuit_column do %>
      <%%= phase_gate theta: '-π/2' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'RNOT' do %>
    <%%= circuit_column do %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= phase_gate theta: '-π/2' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'Built-in RNOT' do %>
    <%%= circuit_column do %>
      <%%= root_not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= root_not_gate %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
    <%% end %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'Root-of-not', circuit_erb: circuit_erb, class: 'mt-8' do %>
    <%= circle_notation do %>
      <%= qubit_circle_group do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: -90, phase_string: '-π/2' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: -45, phase_string: '-π/4' %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: -45, phase_string: '-π/4' %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: -90, phase_string: '-π/2' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 180, phase_string: 'π' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: -45, phase_string: '-π/4' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_header do %>
    <%%= circuit_qubit_label_column do %>
      <%%= qubit_label label: '👩Alice' %>
      <%%= qubit_label label: '😈Eve' %>
      <%%= qubit_label label: '👦🏻Bob' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x1' %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'get two random bits' do %>
    <%%= circuit_column do %>
      <%%= write value: 0 %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= readout value: 0, label: 'alice_h' %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= write value: 0 %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= readout value: 1, label: 'alice_v' %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= write value: 0 %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'set value' do %>
    <%%= circuit_column do %>
      <%%= not_gate label: 'if alice_v' %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'apply H' do %>
    <%%= circuit_column do %>
      <%%= hadamard_gate label: 'if alice_h', disabled: true %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire_down %>
      <%%= wire placeholder: true %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: '🕶spy' do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= hadamard_gate %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= readout value: 1, label: 'eve_v' %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= write value: 0 %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= not_gate label: 'if eve_v' %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= hadamard_gate %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire %>
      <%%= write value: 0 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire %>
      <%%= readout value: 0, label: 'bob_h' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire_down %>
      <%%= wire placeholder: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'apply H' do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= hadamard_gate label: 'if bob_h', disabled: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'readout' do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= readout value: 0 %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'Quantum Spy Hunter', circuit_erb: circuit_erb, class: 'mt-8' do %>
    <%= circle_notation do %>
      <%= qubit_circle_group do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 1 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 1, phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1, phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 1, phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.5 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0.5, phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0.5 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0.5, phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1, phase: 180, phase_string: 'π' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_qubit_label_column do %>
    <%%= qubit_label label: 'qubit 1' %>
    <%%= qubit_label label: 'qubit 2' %>
    <%%= qubit_label label: 'qubit 3' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= qubit_value_label label: '0x1' %>
    <%%= qubit_value_label label: '0x1' %>
    <%%= qubit_value_label label: '0x1' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= write value: 0 %>
    <%%= write value: 0 %>
    <%%= write value: 0 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire %>
    <%%= hadamard_gate %>
    <%%= wire %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire %>
    <%%= wire %>
    <%%= hadamard_gate %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'Separable qubits', circuit_erb: circuit_erb, class: 'mt-8' do %>
    <%= circle_notation do %>
      <%= qubit_circle_group do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.5 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0.5 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0.5 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0.5 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_header do %>
    <%%= circuit_qubit_label_column do %>
      <%%= qubit_label label: 'a' %>
      <%%= qubit_label label: 'b' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x1' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'entangle' do %>
    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= readout value: 1 %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= readout value: 1 %>
    <%% end %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'Entangled qubits', circuit_erb: circuit_erb, class: 'mt-8' do %>
    <%= circle_notation do %>
      <%= qubit_circle_group do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 1 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 1 %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_qubit_label_multicolumn rows: 3 do %>
    <%%= qubit_label_multicolumn label: 'Register 1', row_span: 2 %>
    <%%= qubit_label_multicolumn label: 'Register 2', row_span: 1 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= qubit_value_label label: '0x1' %>
    <%%= qubit_value_label label: '0x2' %>
    <%%= qubit_value_label label: '0x1' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= write value: 0 %>
    <%%= write value: 0 %>
    <%%= wire light: 0 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire %>
    <%%= wire %>
    <%%= write value: 1 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= hadamard_gate %>
    <%%= hadamard_gate %>
    <%%= wire %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= phase_gate theta: 'π/4', bottom: true %>
    <%%= wire top: true, bottom: true %>
    <%%= phase_gate top: true %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire %>
    <%%= phase_gate theta: 'π/2', bottom: true %>
    <%%= phase_gate top: true %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'Phase kickback', circuit_erb: circuit_erb, class: 'mt-8' do %>
    <%= circle_notation do %>
      <%= qubit_circle_group do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 1 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0.5 %>
          <%= qubit_circle ket: 5, magnitude: 0.5 %>
          <%= qubit_circle ket: 6, magnitude: 0.5 %>
          <%= qubit_circle ket: 7, magnitude: 0.5 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0.5 %>
          <%= qubit_circle ket: 5, magnitude: 0.5, phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 6, magnitude: 0.5 %>
          <%= qubit_circle ket: 7, magnitude: 0.5, phase: 45, phase_string: 'π/4' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0.5 %>
          <%= qubit_circle ket: 5, magnitude: 0.5, phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 6, magnitude: 0.5, phase: 90, phase_string: 'π/2' %>
          <%= qubit_circle ket: 7, magnitude: 0.5, phase: 135, phase_string: '3π/4' %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_header do %>
    <%%= circuit_qubit_label_column do %>
      <%%= qubit_label label: 'Input 1' %>
      <%%= qubit_label label: 'Input 2' %>
      <%%= qubit_label label: 'Output' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x1' %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'initialize' do %>
    <%%= circuit_column do %>
      <%%= write value: 0 %>
      <%%= wire light: 0 %>
      <%%= wire light: 0 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= write value: 0 %>
      <%%= wire light: 0 %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'Swap test' do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= write value: 0 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire_down %>
      <%%= wire_up bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= readout value: 1 %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'Swap test', circuit_erb: circuit_erb, class: 'mt-8' do %>
    <%= circle_notation do %>
      <%= qubit_circle_group do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 1 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 1 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 1 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_column do %>
    <%%= qubit_value_label label: '0x1' %>
    <%%= qubit_value_label label: '0x2' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= write value: 0 %>
    <%%= write value: 0 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= hadamard_gate %>
    <%%= hadamard_gate %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire %>
    <%%= phase_gate theta: 'π/4' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= control_dot bottom: true %>
    <%%= not_gate top: true %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire %>
    <%%= phase_gate theta: '-π/4' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= control_dot bottom: true %>
    <%%= not_gate top: true %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= phase_gate theta: 'π/4' %>
    <%%= wire %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= phase_gate theta: 'π/2', bottom: true %>
    <%%= phase_gate top: true %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire %>
    <%%= wire %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'Custom conditional-phase', circuit_erb: circuit_erb, class: 'mt-8' do %>
    <%= circle_notation do %>
      <%= qubit_circle_group do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 1, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 2, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 3, magnitude: 0.5, magnitude_string: '1/2' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 1, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 2, magnitude: 0.5, magnitude_string: '1/2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 3, magnitude: 0.5, magnitude_string: '1/2', phase: 45, phase_string: 'π/4' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 1, magnitude: 0.5, magnitude_string: '1/2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 2, magnitude: 0.5, magnitude_string: '1/2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 3, magnitude: 0.5, magnitude_string: '1/2' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 1, magnitude: 0.5, magnitude_string: '1/2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 2, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 3, magnitude: 0.5, magnitude_string: '1/2', phase: -45, phase_string: '-π/4' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 1, magnitude: 0.5, magnitude_string: '1/2', phase: -45, phase_string: '-π/4' %>
          <%= qubit_circle ket: 2, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 3, magnitude: 0.5, magnitude_string: '1/2', phase: 45, phase_string: 'π/4' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 1, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 2, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 3, magnitude: 0.5, magnitude_string: '1/2', phase: 90, phase_string: 'π/2' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 1, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 2, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 3, magnitude: 0.5, magnitude_string: '1/2', phase: 180, phase_string: 'π' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 1, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 2, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 3, magnitude: 0.5, magnitude_string: '1/2', phase: 180, phase_string: 'π' %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_qubit_label_column do %>
    <%%= qubit_label label: 'a' %>
    <%%= qubit_label label: 'b' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= qubit_value_label label: '0x1' %>
    <%%= qubit_value_label label: '0x1' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= write value: 0 %>
    <%%= write value: 0 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= hadamard_gate %>
    <%%= wire %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire %>
    <%%= hadamard_gate %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire %>
    <%%= phase_gate theta: 'π/4' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire %>
    <%%= hadamard_gate %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= control_dot bottom: true %>
    <%%= not_gate top: true %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= readout value: 1 %>
    <%%= wire %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire light: true %>
    <%%= readout value: 1 %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'Remote-controlled randomness', circuit_erb: circuit_erb, class: 'mt-8' do %>
    <%= circle_notation do %>
      <%= qubit_circle_group do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 1, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 2, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 3, magnitude: 0.5, magnitude_string: '1/2' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 1, magnitude: 0.5, magnitude_string: '1/2' %>
          <%= qubit_circle ket: 2, magnitude: 0.5, magnitude_string: '1/2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 3, magnitude: 0.5, magnitude_string: '1/2', phase: 45, phase_string: 'π/4' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.6532814824381883, magnitude_string: '√2*√(√2/4 + 1/2)/2', phase: 22.511412326678453, phase_string: 'atan(√2/(√2 + 2))' %>
          <%= qubit_circle ket: 1, magnitude: 0.6532814824381883, magnitude_string: '√2*√(√2/4 + 1/2)/2', phase: 22.511412326678453, phase_string: 'atan(√2/(√2 + 2))' %>
          <%= qubit_circle ket: 2, magnitude: 0.2705980500730985, magnitude_string: '√2*√(1/2 - √2/4)/2', phase: -67.53423698003536, phase_string: '-atan(√2/(2 - √2))' %>
          <%= qubit_circle ket: 3, magnitude: 0.2705980500730985, magnitude_string: '√2*√(1/2 - √2/4)/2', phase: -67.53423698003536, phase_string: '-atan(√2/(2 - √2))' %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0.6532814824381883, magnitude_string: '√2*√(√2/4 + 1/2)/2', phase: 22.511412326678453, phase_string: 'atan(√2/(√2 + 2))' %>
          <%= qubit_circle ket: 1, magnitude: 0.2705980500730985, magnitude_string: '√2*√(1/2 - √2/4)/2', phase: -67.53423698003536, phase_string: '-atan(√2/(2 - √2))' %>
          <%= qubit_circle ket: 2, magnitude: 0.2705980500730985, magnitude_string: '√2*√(1/2 - √2/4)/2', phase: -67.53423698003536, phase_string: '-atan(√2/(2 - √2))' %>
          <%= qubit_circle ket: 3, magnitude: 0.6532814824381883, magnitude_string: '√2*√(√2/4 + 1/2)/2', phase: 22.511412326678453, phase_string: 'atan(√2/(√2 + 2))' %>                <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle_group_row do %>
            <%= qubit_circle ket: 0, magnitude: 0 %>
            <%= qubit_circle ket: 1, magnitude: 0.3826834323650898, magnitude_string: '...', phase: -67.53423698003536, phase_string: '-atan(√2/(2 - √2))' %>
            <%= qubit_circle ket: 2, magnitude: 0 %>
            <%= qubit_circle ket: 3, magnitude: 0.9238795325112868, magnitude_string: '...', phase: 22.511412326678453, phase_string: 'atan(√2/(√2 + 2))' %>
          <% end %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle_group_row do %>
            <%= qubit_circle ket: 0, magnitude: 0 %>
            <%= qubit_circle ket: 1, magnitude: 0 %>
            <%= qubit_circle ket: 2, magnitude: 0 %>
            <%= qubit_circle ket: 3, magnitude: 1, magnitude_string: '1', phase: 22.511412326678453, phase_string: 'atan(√2/(√2 + 2))' %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_header do %>
    <%%= circuit_qubit_label_column do %>
      <%%= qubit_label label: '👩Alice' %>
      <%%= qubit_label label: 'ep' %>
      <%%= qubit_label label: '👦🏻Bob' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x1' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'entangle' do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= hadamard_gate %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= write value: 0 %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'prep payload' do %>
    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= phase_gate theta: 'π/4' %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'send' do %>
    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= readout value: 1 %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= readout value: 0 %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'receive' do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= control_dot bottom: true, light: true %>
      <%%= not_gate top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true, light: true %>
      <%%= wire light: true, top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'verify' do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= phase_gate theta: '-π/4' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= readout value: 0 %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'TODO: Basic teleportation', circuit_erb: circuit_erb, class: 'mt-8' do %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_header do %>
    <%%= circuit_qubit_label_multicolumn rows: 4 do %>
      <%%= qubit_label_multicolumn label: 'a', row_span: 4 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x2' %>
      <%%= qubit_value_label label: '0x4' %>
      <%%= qubit_value_label label: '0x8' %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'prepare' do %>
    <%%= circuit_column do %>
      <%%= write value: 1 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= hadamard_gate %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= phase_gate theta: 'π/4' %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'increment' do %>
    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'decrement' do %>
    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'Increment and decrement', circuit_erb: circuit_erb, class: 'mt-8' do %>
    <%= circle_notation size: :sm do %>
      <%= qubit_circle_group do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 1 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 0 %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 0 %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>

      <%= qubit_circle_group class: 'hidden' do %>
        <%= qubit_circle_group_row do %>
          <%= qubit_circle ket: 0, magnitude: 0 %>
          <%= qubit_circle ket: 1, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2' %>
          <%= qubit_circle ket: 2, magnitude: 0 %>
          <%= qubit_circle ket: 3, magnitude: 0 %>
          <%= qubit_circle ket: 4, magnitude: 0 %>
          <%= qubit_circle ket: 5, magnitude: 1 / Math.sqrt(2), magnitude_string: '1/√2', phase: 45, phase_string: 'π/4' %>
          <%= qubit_circle ket: 6, magnitude: 0 %>
          <%= qubit_circle ket: 7, magnitude: 0 %>
          <%= qubit_circle ket: 8, magnitude: 0 %>
          <%= qubit_circle ket: 9, magnitude: 0 %>
          <%= qubit_circle ket: 10, magnitude: 0 %>
          <%= qubit_circle ket: 11, magnitude: 0 %>
          <%= qubit_circle ket: 12, magnitude: 0 %>
          <%= qubit_circle ket: 13, magnitude: 0 %>
          <%= qubit_circle ket: 14, magnitude: 0 %>
          <%= qubit_circle ket: 15, magnitude: 0 %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_header do %>
    <%%= circuit_qubit_label_multicolumn rows: 6 do %>
      <%%= qubit_label_multicolumn label: 'a', row_span: 4 %>
      <%%= qubit_label_multicolumn label: 'b', row_span: 2 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x2' %>
      <%%= qubit_value_label label: '0x4' %>
      <%%= qubit_value_label label: '0x8' %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x2' %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'prepare' do %>
    <%%= circuit_column do %>
      <%%= write value: 1 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= hadamard_gate %>
      <%%= wire %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= phase_gate theta: 'π/4' %>
      <%%= wire %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= write value: 1 %>
      <%%= write value: 0 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= phase_gate theta: 'π/2' %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'a += b' do %>
    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= control_dot top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= control_dot top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'TODO: Adding two quantum integers', circuit_erb: circuit_erb, class: 'mt-8' do %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_header do %>
    <%%= circuit_qubit_label_multicolumn rows: 6 do %>
      <%%= qubit_label_multicolumn label: 'a', row_span: 4 %>
      <%%= qubit_label_multicolumn label: 'b', row_span: 2 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x2' %>
      <%%= qubit_value_label label: '0x4' %>
      <%%= qubit_value_label label: '0x8' %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x2' %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'prepare' do %>
    <%%= circuit_column do %>
      <%%= write value: 1 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= hadamard_gate %>
      <%%= wire %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= phase_gate theta: 'π/4' %>
      <%%= wire %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= write value: 1 %>
      <%%= write value: 0 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= phase_gate theta: 'π/2' %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'a += b * b' do %>
    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= control_dot top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= not_gate bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= wire top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'TODO: Add-squared', circuit_erb: circuit_erb, class: 'mt-8' do %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_header do %>
    <%%= circuit_qubit_label_multicolumn rows: 6 do %>
      <%%= qubit_label_multicolumn label: 'a', row_span: 3 %>
      <%%= qubit_label_multicolumn label: 'b', row_span: 3 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x2' %>
      <%%= qubit_value_label label: '0x4' %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x2' %>
      <%%= qubit_value_label label: '0x4' %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'a = 1, 5' do %>
    <%%= circuit_column do %>
      <%%= write value: 1 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= hadamard_gate %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire light: true %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'b = 1, 3' do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= write value: 1 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= hadamard_gate %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= phase_gate theta: 'π/4' %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'a -= 3' do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'b++ if a < 0' do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'a += 3' do %>
    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'TODO: Quantum conditional execution', circuit_erb: circuit_erb, class: 'mt-8' do %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_header do %>
    <%%= circuit_qubit_label_multicolumn rows: 5 do %>
      <%%= qubit_label_multicolumn label: 'a', row_span: 3 %>
      <%%= qubit_label_multicolumn label: 'b', row_span: 2 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x2' %>
      <%%= qubit_value_label label: '0x4' %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x2' %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'a = 0, 1, 2, 3' do %>
    <%%= circuit_column do %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= wire %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire light: true %>
      <%%= wire light: true %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'b = 1, 3' do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= write value: 1 %>
      <%%= write value: 0 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= hadamard_gate %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'a -= 3' do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'flip if a < 0 && b == 1' do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= not_gate %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block label: 'a += 3' do %>
    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= control_dot bottom: true %>
      <%%= not_gate top: true %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'TODO: Quantum conditional phase flip', circuit_erb: circuit_erb, class: 'mt-8' do %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_qubit_label_column do %>
    <%%= qubit_label label: 'a' %>
    <%%= qubit_label label: 'b' %>
    <%%= qubit_label label: 'c' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= qubit_value_label label: '0x1' %>
    <%%= qubit_value_label label: '0x1' %>
    <%%= qubit_value_label label: '0x1' %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire light: true %>
    <%%= wire light: true %>
    <%%= write value: 0 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire light: true %>
    <%%= wire light: true %>
    <%%= not_gate %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire light: true %>
    <%%= wire light: true %>
    <%%= readout value: 1 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire light: true %>
    <%%= write value: 1 %>
    <%%= wire light: true %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire light: true %>
    <%%= wire %>
    <%%= write value: 0 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire light: true %>
    <%%= control_dot bottom: true %>
    <%%= not_gate top: true %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire light: true %>
    <%%= readout value: 1 %>
    <%%= wire %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= wire light: true %>
    <%%= wire light: true %>
    <%%= readout value: 1 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= write value: 1 %>
    <%%= write value: 1 %>
    <%%= write value: 0 %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= control_dot bottom: true %>
    <%%= control_dot top: true, bottom: true %>
    <%%= not_gate top: true %>
  <%% end %>

  <%%= circuit_column do %>
    <%%= readout value: 1 %>
    <%%= readout value: 1 %>
    <%%= readout value: 1 %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'TODO: CNOT logic', circuit_erb: circuit_erb, class: 'mt-8' do %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_header do %>
    <%%= circuit_qubit_label_multicolumn rows: 4 do %>
      <%%= qubit_label_multicolumn label: 'register', row_span: 4 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x2' %>
      <%%= qubit_value_label label: '0x4' %>
      <%%= qubit_value_label label: '0x8' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'TODO: Repeated iterations', circuit_erb: circuit_erb, class: 'mt-8' do %>
  <% end %>

  <% circuit_erb = capture do %>
<%%= circuit do %>
  <%%= circuit_header do %>
    <%%= circuit_qubit_label_multicolumn rows: 4 do %>
      <%%= qubit_label_multicolumn label: 'register', row_span: 4 %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= qubit_value_label label: '0x1' %>
      <%%= qubit_value_label label: '0x2' %>
      <%%= qubit_value_label label: '0x4' %>
      <%%= qubit_value_label label: '0x8' %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
      <%%= write value: 0 %>
    <%% end %>
  <%% end %>

  <%%= circuit_block_divider do %>
    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= wire %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= control_dot bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true, bottom: true %>
      <%%= control_dot top: true %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
      <%%= not_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
      <%%= hadamard_gate %>
    <%% end %>

    <%%= circuit_column do %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
      <%%= wire %>
    <%% end %>
  <%% end %>
<%% end %>
  <% end %>

  <%= circuit_card heading: 'TODO: Multiple flipped entries', circuit_erb: circuit_erb, class: 'my-8' do %>
  <% end %>
<% end %>
