<% circuit = local_assigns.fetch(:circuit) %>
<% heading = circuit.name %>
<% circuit_erb = circuit.erb %>
<% klass = local_assigns.fetch(:class, nil) %>

<% cache circuit do %>
  <div class="w-full md:w-1/2 lg:w-1/2 xl:w-1/3 p-2 md:p-4">
    <%= card class: klass do %>
      <%= card_header do %>
        <%= card_title text: heading %>
        <div class="flex flex-shrink-0 items-center ml-4">
          <%= link_to 'Open', circuit, type: 'button', class: 'hidden md:inline button button--secondary button--sm' %>
        </div>
      <% end %>

      <%= card_body do %>
        <%= link_to circuit_path(circuit), class: 'card__clickable' do %>
          <div id="<%= dom_id(circuit, :thumbnail) %>"
               class="w-full h-full"
               data-controller="circuit-thumbnail"
               data-action="iframeSize->circuit-thumbnail#iframeSize"
               data-circuit-thumbnail-name="<%= circuit.name %>">
            <div class="w-16 h-16 mx-auto my-auto text-gray-300" data-target="circuit-thumbnail.loader">
              <%= oval_loader %>
            </div>
            <%= circuit_thumbnail circuit: circuit %>
          </div>
        <% end %>
      <% end %>
    <% end %>
  </div>
<% end %>
